/**
 * @file
 * Provides Colorbox integration for Image and Media fields.
 */

!function(o,i,e){"use strict";i.slickColorbox=i.slickColorbox||{};var t,l=o(e);i.behaviors.slickColorbox={attach:function(t,s){if(o.isFunction(o.colorbox)){if(s.colorbox.mobiledetect&&e.matchMedia){var c=e.matchMedia("(max-device-width: "+s.colorbox.mobiledevicewidth+")");if(c.matches)return}o(".slick__slide .slick__colorbox",t).once("slick-colorbox",function(){var e,l=o(this),c=(l.attr("href"),l.closest(".slick").attr("id")),n=o("#"+c).length,a=o("body"),r=l.data("media")||{},d=l.closest(".slick__slider","#"+c+".slick"),x="image"!==r.type?!0:!1,b={iframe:x,rel:r.rel||null,onOpen:function(){a.addClass("colorbox-on colorbox-on--"+r.type),a.data("mediaHeight",""),n&&d.slick("slickPause")},onLoad:function(){if(r=o(this).data("media"),"image"!==r.type&&a.data("mediaHeight",r.height),i.slickColorbox.removeClasses(),a.addClass("colorbox-on colorbox-on--"+r.type),n){if(e=parseInt(l.closest(".slick__slide:not(.slick-cloned)").data("slickIndex")),d.parent().next(".slick").length){var t=d.parent().next(".slick").find(".slick__slider");t.slick("slickGoTo",e)}d.slick("slickGoTo",e)}},onCleanup:function(){i.slickColorbox.removeClasses()},onComplete:function(){"image"!==r.type&&i.slickColorbox.resize(t,i.settings)},onClosed:function(){i.slickColorbox.jumpScroll("#"+c,120),i.slickColorbox.removeClasses(),a.data("mediaHeight","")}};l.colorbox(o.extend({},s.colorbox,b))}),l.bind("resize",function(){i.slickColorbox.resize(t,i.settings)}),o(t).bind("cbox_complete",function(){i.attachBehaviors("#cboxLoadedContent")})}}},i.slickColorbox.removeClasses=function(){o("body").removeClass("colorbox-on colorbox-on--image colorbox-on--video colorbox-on--audio")},i.slickColorbox.jumpScroll=function(i,e){o(i).length&&o("html, body").stop().animate({scrollTop:o(i).offset().top-e},800)},i.slickColorbox.resize=function(i,l){t&&clearTimeout(t);var s=l.colorbox.maxWidth,c=l.colorbox.maxHeight,n={width:"98%",height:"98%",maxWidth:s.indexOf("px")>0?parseInt(s):s,maxHeight:c.indexOf("px")>0?parseInt(c):c};t=setTimeout(function(){if(o("#cboxOverlay").is(":visible")){var i=o("#cboxLoadedContent"),t=o("> img, > iframe, > .node",i);o.colorbox.resize({width:e.innerWidth>n.maxWidth?n.maxWidth:n.width}),t.css({width:i.innerWidth(),height:"undefined"!==o("body").data("mediaHeight")?o("body").data("mediaHeight"):"auto"}),i.height(t.height()),o.colorbox.resize()}},0)}}(jQuery,Drupal,this,this.document);
